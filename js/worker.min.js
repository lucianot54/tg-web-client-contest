!function(){"use strict";const r=r=>{const t=new Uint8Array(r);return crypto.getRandomValues(t),t},t=(t,n)=>{const e=n-t.length%n;return 0==e||e==n?new Uint8Array(t):new Uint8Array([...t,...r(e)])},n=[[[],[],[],[],[]],[[],[],[],[],[]]],e=n[0],o=n[1],a=e[4],f=o[4],l=[],i=[];for(let r=0;r<256;r++)i[(l[r]=r<<1^283*(r>>7))^r]=r;for(let r=0,t=0,n=0;!a[r];r^=n||1,t=i[t]||1){let i=t^t<<1^t<<2^t<<3^t<<4;i=i>>8^255&i^99,a[r]=i,f[i]=r;let h=0;let g=16843009*l[h=l[n=l[r]]]^65537*h^257*n^16843008*r,u=257*l[i]^16843008*i;for(let t=0;t<4;t++)e[t][r]=u=u<<24^u>>>8,o[t][i]=g=g<<24^g>>>8}for(let r=0;r<5;r++)e[r]=e[r].slice(0),o[r]=o[r].slice(0);const h=r=>{const t=[];for(let n=0;n<r.length;n+=4)t.push(r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]);return t},g=r=>{const t=[];for(let n=0;n<r.length;n++)t.push(r[n]>>24&255),t.push(r[n]>>16&255),t.push(r[n]>>8&255),t.push(r[n]>>0&255);return t},u=(r,t,n)=>{for(var e=0;e<16;e++)r[n+e]^=t[e]},c=(r,t,e)=>{let o=t[0]^r[0],a=t[e?3:1]^r[1],f=t[2]^r[2],l=t[e?1:3]^r[3],i=0,h=0,g=0,u=4;const c=n[e],s=c[0],y=c[1],w=c[2],v=c[3],A=c[4],p=[0,0,0,0];for(let t=0;t<13;t++)i=s[o>>>24]^y[a>>16&255]^w[f>>8&255]^v[255&l]^r[u],h=s[a>>>24]^y[f>>16&255]^w[l>>8&255]^v[255&o]^r[u+1],g=s[f>>>24]^y[l>>16&255]^w[o>>8&255]^v[255&a]^r[u+2],l=s[l>>>24]^y[o>>16&255]^w[a>>8&255]^v[255&f]^r[u+3],u+=4,o=i,a=h,f=g;for(let t=0;t<4;t++)p[e?3&-t:t]=A[o>>>24]<<24^A[a>>16&255]<<16^A[f>>8&255]<<8^A[255&l]^r[u++],i=o,o=a,a=f,f=l,l=i;return p},s=(r,t)=>{const e=h(r).slice(0),o=n[0][4];let a,f=0,l=1;for(a=8;a<60;a++){let r=e[a-1];a%8!=0&&a%8!=4||(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],a%8==0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),e[a]=e[a-8]^r}if(0==t)return e;const i=[],g=n[1];for(let r=0;a;r++,a--)f=e[3&r?a:a-4],i[r]=a<=4||r<4?f:g[0][o[f>>>24]]^g[1][o[f>>16&255]]^g[2][o[f>>8&255]]^g[3][o[255&f]];return i};let y=0;const w={},v=async r=>{const t=await crypto.subtle.digest("SHA-1",r);return new Uint8Array(t)},A=async r=>{const t=await crypto.subtle.digest("SHA-256",r);return new Uint8Array(t)};var p,d=0,m=0,U="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(d=0;1<<d+1>1<<d;d++);p=(m=(1<<(d>>=1))-1)+1;var b,M,x=Q(1,1,1),k=(Q(0,1,1),new Array(0)),B=k,I=k,P=k,S=k,z=k,D=k,H=k,K=k,C=k,E=k,F=k,O=k,j=k;function q(r,t){var n=Q(0,(r.length>t?r.length:t)*d,0);return tr(n,r),n}function G(r,t){var n=q(r,r.length+t.length);return function(r,t){var n;B.length!=2*r.length&&(B=new Array(2*r.length));for(nr(B,0),n=0;n<t.length;n++)t[n]&&hr(B,r,t[n],n);tr(r,B)}(n,t),Ar(n,1)}function R(r,t,n){var e=q(r,n.length);return function(r,t,n){var e,o,a,f;H.length!=n.length&&(H=rr(n));if(0==(1&n[0])){for(tr(H,r),nr(r,1);!X(t,0);)1&t[0]&&wr(r,H,n),ir(t,2),vr(H,n);return}for(nr(H,0),a=n.length;a>0&&!n[a-1];a--);f=p-function(r,t){for(var n=1,e=0;;){if(1===r)return n;if(0===r)return 0;if(e-=n*Math.floor(t/r),1===(t%=r))return e;if(0===t)return 0;n-=e*Math.floor(r/t),r%=t}}(function(r,t){var n,e=0;for(n=r.length-1;n>=0;n--)e=(e*p+r[n])%t;return e}(n,p),p),H[a]=1,wr(r,H,n),P.length!=r.length?P=rr(r):tr(P,r);for(e=t.length-1;e>0&!t[e];e--);if(0==t[e])return void nr(r,1);for(o=1<<d-1;o&&!(t[e]&o);o>>=1);for(;;){if(!(o>>=1)){if(--e<0)return void pr(r,x,n,f);o=1<<d-1}pr(r,r,n,f),o&t[e]&&pr(r,P,n,f)}}(e,Ar(t,2),Ar(n,2)),Ar(e,1)}function T(r,t){var n=q(r,r.length>t.length?r.length+1:t.length+1);return cr(n,t),Ar(n,1)}function V(r,t,n,e,o){var a=0,f=Math.max(r.length,t.length);for(C.length!=f&&(C=new Array(f),E=new Array(f),F=new Array(f),O=new Array(f),j=new Array(f));!(1&r[0]||1&t[0]);)ar(r),ar(t),a++;for(tr(C,r),tr(n,t),nr(E,1),nr(F,0),nr(O,0),nr(j,1);;){for(;!(1&C[0]);)ar(C),1&E[0]||1&F[0]?(sr(E,t),ar(E),cr(F,r),ar(F)):(ar(E),ar(F));for(;!(1&n[0]);)ar(n),1&O[0]||1&j[0]?(sr(O,t),ar(O),cr(j,r),ar(j)):(ar(O),ar(j));if(L(n,C)?(cr(n,C),cr(O,E),cr(j,F)):(cr(C,n),cr(E,O),cr(F,j)),X(C,0)){for(;Z(O);)sr(O,t),cr(j,r);return lr(j,-1),tr(e,O),tr(o,j),void fr(n,a)}}}function Z(r){return r[r.length-1]>>d-1&1}function J(r,t,n){var e,o=r.length,a=t.length;for(b=o+n<a?o+n:a,e=a-1-n;e<o&&e>=0;e++)if(r[e]>0)return 1;for(e=o-1+n;e<a;e++)if(t[e]>0)return 0;for(e=b-1;e>=n;e--){if(r[e-n]>t[e])return 1;if(r[e-n]<t[e])return 0}return 0}function L(r,t){var n,e=r.length<t.length?r.length:t.length;for(n=r.length;n<t.length;n++)if(t[n])return 0;for(n=t.length;n<r.length;n++)if(r[n])return 1;for(n=e-1;n>=0;n--){if(r[n]>t[n])return 1;if(r[n]<t[n])return 0}return 0}function N(r,t,n,e){var o,a,f,l,i,h,g,u;for(tr(e,r),a=t.length;0===t[a-1];a--);for(u=t[a-1],g=0;u;g++)u>>=1;for(fr(t,g=d-g),fr(e,g),o=e.length;0===e[o-1]&&o>a;o--);for(nr(n,0);!J(t,e,o-a);)ur(e,t,o-a),n[o-a]++;for(f=o-1;f>=a;f--){for(e[f]==t[a-1]?n[f-a]=m:n[f-a]=Math.floor((e[f]*p+e[f-1])/t[a-1]);h=(i=(a>1?t[a-2]:0)*n[f-a])>>d,i&=m,h=(l=h+n[f-a]*t[a-1])>>d,l&=m,h==e[f]?l==e[f-1]?i>(f>1?e[f-2]:0):l>e[f-1]:h>e[f];)n[f-a]--;hr(e,t,-n[f-a],f-a),Z(e)&&(gr(e,t,f-a),n[f-a]--)}or(t,g),or(e,g)}function Q(r,t,n){var e;e=n>(e=Math.ceil(t/d)+1)?n:e;var o=new Array(e);return nr(o,r),o}function W(r,t,n){var e,o,a,f,l,i=r.length;if(-1===t){for(a=new Array(0);;){for(f=new Array(a.length+1),o=0;o<a.length;o++)f[o+1]=a[o];if(f[0]=parseInt(r,10),a=f,(e=r.indexOf(",",0))<1)break;if(0==(r=r.substring(e+1)).length)break}return a.length<n?(tr(f=new Array(n),a),f):a}for(a=Q(0,t*i,0),o=0;o<i&&(e=U.indexOf(r.substring(o,o+1),0),t<=36&&e>=36&&(e-=26),!(e>=t||e<0));o++)lr(a,t),er(a,e);for(i=a.length;i>0&&!a[i-1];i--);for(i=n>i+1?n:i+1,f=new Array(i),l=i<a.length?i:a.length,o=0;o<l;o++)f[o]=a[o];for(;o<i;o++)f[o]=0;return f}function X(r,t){var n;if(r[0]!=t)return 0;for(n=1;n<r.length;n++)if(r[n])return 0;return 1}function Y(r,t){var n,e=r.length<t.length?r.length:t.length;for(n=0;n<e;n++)if(r[n]!==t[n])return 0;if(r.length>t.length){for(;n<r.length;n++)if(r[n])return 0}else for(;n<t.length;n++)if(t[n])return 0;return 1}function $(r){var t;for(t=0;t<r.length;t++)if(r[t])return 0;return 1}function _(r,t){var n,e,o="";if(D.length!==r.length?D=rr(r):tr(D,r),-1===t){for(n=r.length-1;n>0;n--)o+=r[n]+",";o+=r[0]}else for(;!$(D);)e=ir(D,t),o=U.substring(e,e+1)+o;return 0===o.length&&(o="0"),o}function rr(r){return tr(M=Array(r.length),r),M}function tr(r,t){var n,e=r.length<t.length?r.length:t.length;for(n=0;n<e;n++)r[n]=t[n];for(n=e;n<r.length;n++)r[n]=0}function nr(r,t){var n,e,o=r.length;for(e=t,n=0;n<o;n++)r[n]=e&m,e>>=d}function er(r,t){var n,e,o,a;for(r[0]+=t,e=r.length,o=0,n=0;n<e;n++)if(a=0,(o+=r[n])<0&&(o+=(a=-(o>>d))*p),r[n]=o&m,!(o=(o>>d)-a))return}function or(r,t){var n,e=Math.floor(t/d);if(e){for(n=0;n<r.length-e;n++)r[n]=r[n+e];for(;n<r.length;n++)r[n]=0;t%=d}for(n=0;n<r.length-1;n++)r[n]=m&(r[n+1]<<d-t|r[n]>>t);r[n]>>=t}function ar(r){var t;for(t=0;t<r.length-1;t++)r[t]=m&(r[t+1]<<d-1|r[t]>>1);r[t]=r[t]>>1|r[t]&p>>1}function fr(r,t){var n,e=Math.floor(t/d);if(e){for(n=r.length;n>=e;n--)r[n]=r[n-e];for(;n>=0;n--)r[n]=0;t%=d}if(t){for(n=r.length-1;n>0;n--)r[n]=m&(r[n]<<t|r[n-1]>>d-t);r[n]=m&r[n]<<t}}function lr(r,t){var n,e,o,a;if(t)for(e=r.length,o=0,n=0;n<e;n++)a=0,(o+=r[n]*t)<0&&(o+=(a=-(o>>d))*p),r[n]=o&m,o=(o>>d)-a}function ir(r,t){var n,e,o=0;for(n=r.length-1;n>=0;n--)e=o*p+r[n],r[n]=Math.floor(e/t),o=e%t;return o}function hr(r,t,n,e){var o,a,f,l;for(f=r.length<e+t.length?r.length:e+t.length,l=r.length,a=0,o=e;o<f;o++)a+=r[o]+n*t[o-e],r[o]=a&m,a>>=d;for(o=f;a&&o<l;o++)a+=r[o],r[o]=a&m,a>>=d}function gr(r,t,n){var e,o,a,f;for(a=r.length<n+t.length?r.length:n+t.length,f=r.length,o=0,e=n;e<a;e++)o+=r[e]+t[e-n],r[e]=o&m,o>>=d;for(e=a;o&&e<f;e++)o+=r[e],r[e]=o&m,o>>=d}function ur(r,t,n){var e,o,a,f;for(a=r.length<n+t.length?r.length:n+t.length,f=r.length,o=0,e=n;e<a;e++)o+=r[e]-t[e-n],r[e]=o&m,o>>=d;for(e=a;o&&e<f;e++)o+=r[e],r[e]=o&m,o>>=d}function cr(r,t){var n,e,o;for(o=r.length<t.length?r.length:t.length,e=0,n=0;n<o;n++)e+=r[n]-t[n],r[n]=e&m,e>>=d;for(n=o;e&&n<r.length;n++)e+=r[n],r[n]=e&m,e>>=d}function sr(r,t){var n,e,o;for(o=r.length<t.length?r.length:t.length,e=0,n=0;n<o;n++)e+=r[n]+t[n],r[n]=e&m,e>>=d;for(n=o;e&&n<r.length;n++)e+=r[n],r[n]=e&m,e>>=d}function yr(r,t){S.length!==r.length?S=rr(r):tr(S,r),z.length!==r.length&&(z=rr(r)),N(S,t,z,r)}function wr(r,t,n){var e;for(I.length!=2*r.length&&(I=new Array(2*r.length)),nr(I,0),e=0;e<t.length;e++)t[e]&&hr(I,r,t[e],e);yr(I,n),tr(r,I)}function vr(r,t){var n,e,o,a,f;for(a=r.length;a>0&&!r[a-1];a--);for(f=a>t.length?2*a:2*t.length,I.length!=f&&(I=new Array(f)),nr(I,0),n=0;n<a;n++){for(o=I[2*n]+r[n]*r[n],I[2*n]=o&m,o>>=d,e=n+1;e<a;e++)o=I[n+e]+2*r[n]*r[e]+o,I[n+e]=o&m,o>>=d;I[n+a]=o}yr(I,t),tr(r,I)}function Ar(r,t){var n,e;for(n=r.length;n>0&&!r[n-1];n--);return tr(e=new Array(n+t),r),e}function pr(r,t,n,e){var o,a,f,l,i,h,g=n.length,u=t.length;for(K.length!=g&&(K=new Array(g)),nr(K,0);g>0&&0==n[g-1];g--);for(;u>0&&0==t[u-1];u--);for(h=K.length-1,o=0;o<g;o++){for(f=(i=K[0]+r[o]*t[0])+(l=(i&m)*e&m)*n[0]>>d,i=r[o],a=1;a<u-4;)f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++;for(;a<u;)f+=K[a]+l*n[a]+i*t[a],K[a-1]=f&m,f>>=d,a++;for(;a<g-4;)f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++,f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++;for(;a<g;)f+=K[a]+l*n[a],K[a-1]=f&m,f>>=d,a++;for(;a<h;)f+=K[a],K[a-1]=f&m,f>>=d,a++;K[a-1]=f&m}L(n,K)||cr(K,n),tr(r,K)}const dr=r=>Math.floor(Math.random()*r),mr=r=>r.reduce((r,t)=>r+t.toString(16).padStart(2,"0"),""),Ur=r=>(r.length%2&&(r="0"+r),new Uint8Array(r.match(/.{1,2}/g).map(r=>parseInt(r,16)))),br=r=>{const t=R(W(mr(r.x),16),W(mr(r.y),16),W(mr(r.m),16));return r.returnBigInt?t:Ur(_(t,16))},Mr=async(r,t)=>await A(Uint8Array.from([...t,...r,...t]));importScripts("gunzip.min.js");const xr={importAesCtrData:r=>{const t=s(r.key,r.type||0),n=y++;return w[n]={key:t,iv:r.iv,rc:null,rcIndex:16},n},cryptAesCtr:r=>{const t=w[r.id],n=t.iv,e=new Uint8Array(r.data);for(let r=0,o=e.length;r<o;r++){if(16==t.rcIndex){t.rc=g(c(t.key,h(n),0)),t.rcIndex=0;for(let r=15;r>=0;r--){if(255!==n[r]){n[r]++;break}n[r]=0}}e[r]^=t.rc[t.rcIndex++]}return e},cryptAesIge:r=>{const n=r.type||0,e=s(r.key,n),o=t(r.data,16);let a=r.iv.slice(0,16),f=r.iv.slice(16,32);for(let r=0,t=o.length;r<t;r+=16){const t=o.slice(r,r+16);u(o,0==n?a:f,r);const l=h(o.slice(r,r+16));o.set(g(c(e,l,n)),r),u(o,0==n?f:a,r);const i=o.slice(r,r+16);a=0==n?i:t,f=0==n?t:i}return o}};xr.bytesModPow=br,xr.encryptPassword=async t=>{const n=r(256),e=Uint8Array.from([...new Uint8Array(255),t.g]),o=br({x:e,y:n,m:t.p}),a=W(mr(await A(Uint8Array.from([...t.p,...e]))),16),f=W(mr(await A(Uint8Array.from([...o,...t.srpB]))),16),l=(new TextEncoder).encode(t.password),i=await Mr(await Mr(l,t.salt1),t.salt2),h=await(async(r,t)=>{const n=await crypto.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]);return new Uint8Array(await crypto.subtle.deriveBits({name:"PBKDF2",hash:"SHA-512",salt:t,iterations:1e5},n,512))})(i,t.salt1),g=await Mr(h,t.salt2),u=br({x:Uint8Array.from([t.g]),y:g,m:t.p,returnBigInt:!0}),c=W(mr(t.p),16),s=function(r,t,n){var e=q(r,n.length);return wr(e,t,n),Ar(e,1)}(a,u,c),y=W(mr(t.srpB),16);L(s,y)&&sr(y,c);const w=R(function(r,t){var n=rr(r);return yr(n,t),Ar(n,1)}(T(y,s),c),function(r,t){var n=q(r,r.length>t.length?r.length+1:t.length+1);return sr(n,t),Ar(n,1)}(W(mr(n),16),G(f,W(mr(g),16))),c);return{A:o,M1:await A(Uint8Array.from([...(v=await A(t.p),p=await A(e),new Uint8Array(v.length).map((r,t)=>v[t]^p[t])),...await A(t.salt1),...await A(t.salt2),...o,...t.srpB,...await A(Ur(_(w,16)))]))};var v,p},xr.factorize=r=>{const t=Math.ceil(64/d)+1,n=W(mr(r),16,t);let e=0;const o=new Array(t),a=new Array(t),f=new Array(t),l=new Array(t),i=new Array(t),h=new Array(t),g=new Array(t);for(let r=0;r<3;r++){const t=17+(15&dr(128));nr(i,dr(1e9)+1),tr(h,i),e=1<<r+18;for(let r=0;r<e;r++){for(tr(o,i),tr(a,i),nr(f,t);!$(a);)1&a[0]&&(sr(f,o),L(f,n)&&cr(f,n)),sr(o,o),L(o,n)&&cr(o,n),or(a,1);if(tr(i,f),L(i,h)?(tr(g,i),cr(g,h)):(tr(g,h),cr(g,i)),V(g,n,l,o,a),!X(l,1))break;0==(r&r-1)&&tr(h,i)}if(L(l,x))break}let u,c;return N(n,l,i,h),L(l,i)?(u=i,c=l):(u=l,c=i),{p:Ur(_(u,16)),q:Ur(_(c,16))}},xr.rsaEncrypt=async r=>{const n=r.key,e=r.data,o=new Uint8Array([...await v(e),...new Uint8Array(e)]),a=t(o,255);return Ur(_(R(W(mr(a),16),W("10001",16),W(n,16)),16))},xr.verifyDhParams=async r=>{const t=r.g,n=r.dhPrime,e=r.gA,o=mr(await v(n));if(3!=t||"465bd03478c819c41d4e654c0c9a9978888485cf"!=o)return!1;const a=W(mr(e),16),f=W(mr(n),16);if(L(x,a)||Y(x,a))return!1;const l=T(f,x);if(L(a,l)||Y(a,l))return!1;let i=1983;const h=Q(2,i,1);for(;i--;)lr(h,2);if(L(h,a))return!1;const g=T(f,h);return!L(a,g)&&!Y(a,g)},xr.sha1=v,xr.sha256=A,xr.gunzip=r=>new Zlib.Gunzip(r).decompress(),onmessage=async r=>{const t=r.data;t.result=await xr[t.method](t.params),postMessage(t)}}();
